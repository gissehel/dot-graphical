#!/usr/bin/env bash

repo_location=~/dev/project
tmp_dir=~/tmp

mkdir -p "${repo_location}"
mkdir -p "${tmp_dir}"

curl https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor > microsoft.gpg
sudo install -o root -g root -m 644 microsoft.gpg /etc/apt/trusted.gpg.d/
sudo sh -c 'echo "deb [arch=amd64] https://packages.microsoft.com/repos/vscode stable main" > /etc/apt/sources.list.d/vscode.list'
/usr/lib/apt/apt-helper download-file http://debian.sur5r.net/i3/pool/main/s/sur5r-keyring/sur5r-keyring_2019.02.01_all.deb "${tmp_dir}/keyring.deb" SHA256:176af52de1a976f103f9809920d80d02411ac5e763f695327de9fa6aff23f416
sudo dpkg -i "${tmp_dir}/keyring.deb"
echo "deb http://debian.sur5r.net/i3/ $(grep '^DISTRIB_CODENAME=' /etc/lsb-release | cut -f2 -d=) universe" | (sudo bash -c 'cat > /etc/apt/sources.list.d/sur5r-i3.list')
rm -f "${tmp_dir}/keyring.deb"
wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main" | sudo tee /etc/apt/sources.list.d/google-chrome.list

sudo apt update && sudo apt install -y autoconf gawk make gcc fonts-font-awesome i3 rofi gsimplecal google-chrome-stable code

[ -d "${repo_location}/i3blocks" ] || {
    git clone "https://github.com/vivien/i3blocks" "${repo_location}/i3blocks"
    cd "${repo_location}/i3blocks"
    ./autogen.sh
    ./configure
    make
    ln -s ../dev/project/i3blocks/i3blocks ~/bin/i3blocks
}
[ -d "${repo_location}/i3blocks-contrib" ] || git clone "https://github.com/vivien/i3blocks-contrib" "${repo_location}/i3blocks-contrib"


